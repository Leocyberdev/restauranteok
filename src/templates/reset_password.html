<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redefinir Senha - Sabor & Arte</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='auth-style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="auth-container">
        <!-- Seção da imagem e descrição do restaurante -->
        <div class="restaurant-section">
            <div class="restaurant-overlay">
                <div class="restaurant-content">
                    <div class="logo">
                        <i class="fas fa-utensils"></i>
                        <h1>Sabor & Arte</h1>
                    </div>
                    <div class="restaurant-description">
                        <h2>Redefinir sua senha</h2>
                        <p>Digite sua nova senha para recuperar o acesso à sua conta e continuar desfrutando de nossa experiência gastronômica única.</p>
                        <div class="features">
                            <div class="feature">
                                <i class="fas fa-shield-alt"></i>
                                <span>Segurança garantida</span>
                            </div>
                            <div class="feature">
                                <i class="fas fa-key"></i>
                                <span>Acesso protegido</span>
                            </div>
                            <div class="feature">
                                <i class="fas fa-lock"></i>
                                <span>Dados criptografados</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção do formulário -->
        <div class="form-section">
            <div class="form-container">
                <div class="form-header">
                    <h2>Nova Senha</h2>
                    <p>Digite sua nova senha abaixo</p>
                </div>

                <!-- Mensagens de erro/sucesso -->
                {% with messages = get_flashed_messages() %}
                    {% if messages %}
                        <div class="alert-container">
                            {% for message in messages %}
                                <div class="alert">
                                    <i class="fas fa-exclamation-circle"></i>
                                    <span>{{ message }}</span>
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                {% endwith %}

                <!-- Formulário de Nova Senha -->
                <form method="POST" class="auth-form active">
                    <div class="input-group">
                        <div class="input-wrapper">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="new-password" name="password" placeholder="Nova senha" required>
                            <button type="button" class="toggle-password" onclick="togglePassword('new-password')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="input-group">
                        <div class="input-wrapper">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="confirm-new-password" name="confirm_password" placeholder="Confirmar nova senha" required>
                            <button type="button" class="toggle-password" onclick="togglePassword('confirm-new-password')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="password-strength">
                        <div class="strength-bar">
                            <div class="strength-fill"></div>
                        </div>
                        <span class="strength-text">Força da senha</span>
                    </div>

                    <button type="submit" class="submit-btn">
                        <span>Redefinir Senha</span>
                        <i class="fas fa-check"></i>
                    </button>
                </form>

                <!-- Navegação -->
                <div class="form-navigation">
                    <div class="nav-links">
                        <span>Lembrou da senha?</span>
                        <a href="{{ url_for('auth.login') }}">Voltar ao login</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const button = input.nextElementSibling;
            const icon = button.querySelector('i');

            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        // Validação de força da senha
        document.getElementById('new-password').addEventListener('input', function() {
            const password = this.value;
            const strengthBar = document.querySelector('.strength-fill');
            const strengthText = document.querySelector('.strength-text');
            
            let strength = 0;
            let text = 'Muito fraca';
            
            if (password.length >= 8) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;
            
            const percentage = (strength / 5) * 100;
            strengthBar.style.width = percentage + '%';
            
            if (strength <= 1) {
                text = 'Muito fraca';
                strengthBar.style.backgroundColor = '#ff4757';
            } else if (strength <= 2) {
                text = 'Fraca';
                strengthBar.style.backgroundColor = '#ffa502';
            } else if (strength <= 3) {
                text = 'Média';
                strengthBar.style.backgroundColor = '#ffb142';
            } else if (strength <= 4) {
                text = 'Forte';
                strengthBar.style.backgroundColor = '#2ed573';
            } else {
                text = 'Muito forte';
                strengthBar.style.backgroundColor = '#1dd1a1';
            }
            
            strengthText.textContent = text;
        });

        // Validação de confirmação de senha
        document.getElementById('confirm-new-password').addEventListener('input', function() {
            const password = document.getElementById('new-password').value;
            const confirmPassword = this.value;
            
            if (confirmPassword && password !== confirmPassword) {
                this.setCustomValidity('As senhas não coincidem');
            } else {
                this.setCustomValidity('');
            }
        });
    </script>
</body>
</html>

